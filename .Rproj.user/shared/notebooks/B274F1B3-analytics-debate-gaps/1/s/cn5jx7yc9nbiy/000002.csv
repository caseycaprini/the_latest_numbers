"0","p_fg <- 0.99"
"0","q_fg <- 1 - p_fg"
"0","wp_p_fg <- 63"
"0","wp_q_fg <- 53"
"0",""
"0","p_go <- 0.60"
"0","q_go <- 1 - p_go"
"0","wp_p_go <- 73"
"0","wp_q_go <- 53"
"0",""
"0","e_wp_fg <- (p_fg * wp_p_fg) + (q_fg * wp_q_fg)"
"0","e_wp_go <- (p_go * wp_p_go) + (q_go * wp_q_go)"
"0","e_wp_go - e_wp_fg"
"1","[1]"
"1"," 2.1"
"1","
"
"0","n = 10000"
"0",""
"0","# SE 0.02 since FG% far from 100%"
"0","p_fg_err <- rnorm(n, 0, 0.0025)"
"0","p_fg_dist <- p_fg + p_fg_err"
"0","q_fg_dist <- 1 - p_fg_dist"
"0","p_go_err <- rnorm(n, 0, 0.025)"
"0","p_go_dist <- p_go + p_go_err"
"0","q_go_dist <- 1 - p_go_dist"
"0",""
"0","wp_p_fg_err <- rnorm(n, 0, 2.5)"
"0","wp_p_fg_dist <- wp_p_fg + wp_p_fg_err"
"0","wp_q_fg_err <- rnorm(n, 0, 2.5)"
"0","wp_q_fg_dist <- wp_q_fg + wp_q_fg_err"
"0","wp_p_go_err <- rnorm(n, 0, 2.5)"
"0","wp_p_go_dist <- wp_p_go + wp_p_go_err"
"0","wp_q_go_err <- rnorm(n, 0, 2.5)"
"0","wp_q_go_dist <- wp_q_go + wp_q_go_err"
"0",""
"0","e_wp_go_sim <- (p_go_dist * wp_p_go_dist) + (q_go_dist * wp_q_go_dist)"
"0","e_wp_fg_sim <- (p_fg_dist * wp_p_fg_dist) + (q_fg_dist * wp_q_fg_dist)"
"0","e_wp_sim <- e_wp_go_sim - e_wp_fg_sim"
"0",""
"0","df <- data.frame(e_wp_adv_go = e_wp_sim) %>%"
"0","  mutate(recommendation = case_when(e_wp_adv_go <= -1 ~ ""Kick"","
"0","                                    e_wp_adv_go > -1 & e_wp_adv_go < 1 ~ ""Toss up"","
"0","                                    e_wp_adv_go >= 1 ~ ""Go""))"
"0",""
"0","sim_mean <- df %>%"
"0","  pull(e_wp_adv_go) %>%"
"0","  mean() %>%"
"0","  round(digits = 1)"
"0","sim_sd <- df %>%"
"0","  pull(e_wp_adv_go) %>%"
"0","  sd() %>%"
"0","  round(digits = 1)"
"0",""
"0","df_summ <- df %>%"
"0","  group_by(recommendation) %>%"
"0","  summarize(percent_sims = n()/nrow(df)) %>%"
"0","  mutate(percent_sims = round(percent_sims * 100, 1))"
"0",""
"0","df %>%"
"0","  ggplot(aes(x = e_wp_adv_go)) +"
"0","  geom_vline(xintercept = 0,"
"0","             color = ""black"") +"
"0","  geom_vline(xintercept = e_wp_go - e_wp_fg,"
"0","             color = ""black"","
"0","             size = 2) +"
"0","  geom_histogram(binwidth = 0.5,"
"0","                 color = ""black"","
"0","                 aes(fill = recommendation)) +"
"0","  theme_light() +"
"0","  scale_y_continuous(breaks = NULL) +"
"0","  scale_x_continuous(breaks = seq(from = -30, to = 30, by = 2),"
"0","                     minor_breaks = NULL) +"
"0","  scale_fill_manual(values = c(""green"", ""red"", ""yellow"")) +"
"0","  labs(x = ""E[WP] Advantage for 'Go'"","
"0","       y = NULL,"
"0","       title = ""Simulation with Modest Random Error in Estimated Parameters"","
"0","       subtitle = ""Distribution of 10,000 sims."") +"
"0","  theme(legend.position = ""none"") +"
"0","  geom_label(aes(x = -4, y = 250,"
"0","                 label = paste0(""Bot advantage: "","
"0","                                round(e_wp_go - e_wp_fg, 1),"
"0","                                ""\nSim mean: "","
"0","                                sim_mean,"
"0","                                ""\nSim sd: "","
"0","                                sim_sd,"
"0","                                ""\nSim Go Rate: "","
"0","                                df_summ %>%"
"0","                                  filter(recommendation == ""Go"") %>%"
"0","                                  pull(percent_sims)))) -> p"
"0",""
"0","ggsave(filename = ""lac_wk_15_sim_with_parameter_error_end_half.png"","
"0","       p,"
"0","       height = 6,"
"0","       width = 9,"
"0","       units = ""in"","
"0","       dpi = ""retina"")"
