"0",""
"0","rand_int <- lmer(yards_gained ~ 1 + (1|posteam) + (1|defteam),"
"0","                 data = pbp_df)"
"0",""
"0","off_rand_int <- coef(rand_int)$posteam %>%"
"0","  rownames_to_column(var = ""team"") %>%"
"0","  rename(off_estimate = `(Intercept)`)"
"0",""
"0","def_rand_int <- coef(rand_int)$defteam %>%"
"0","  rownames_to_column(var = ""team"") %>%"
"0","  rename(def_estimate = `(Intercept)`)"
"0",""
"0","unit_est <- left_join(off_rand_int,"
"0","                      def_rand_int,"
"0","                      by = c(""team"" = ""team""))"
"0",""
"0","df <- left_join(unit_avg,"
"0","                unit_est,"
"0","                by = c(""team"" = ""team"")) %>%"
"0","  mutate(def_adjustment = def_estimate - def_yards_per_play,"
"0","         off_adjustment = off_estimate - off_yards_per_play)"
"0",""
"0","yards_per_play <- mean(pbp_df$yards_gained)"
"0",""
"0","rm(off_rand_int,"
"0","   def_rand_int,"
"0","   unit_avg,"
"0","   unit_est,"
"0","   pbp_df)"
"0",""
