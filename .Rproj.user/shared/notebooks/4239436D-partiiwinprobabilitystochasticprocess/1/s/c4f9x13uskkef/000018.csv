"0",""
"0","stochastic_model <-"
"0","  expand_grid(game_seconds_played = seq(0, 3600, by = 30),"
"0","              wp = seq(0.05, 0.95, by = 0.05)) %>%"
"0","  mutate(dist_from_certainty = 0.5 - abs(wp - 0.5)) %>%"
"0","  mutate(wpa_sd_model = (0.07*dist_from_certainty) + ((75*dist_from_certainty)/(3875 - game_seconds_played))) %>%"
"0","  mutate(vegas_home_wp = wp) %>%"
"0","  mutate(lower_bound_1 = -1 * wpa_sd_model,"
"0","         lower_bound_2 = -2 * wpa_sd_model,"
"0","         upper_bound_1 = 1 * wpa_sd_model,"
"0","         upper_bound_2 = 2 * wpa_sd_model)"
"0",""
"0","p_stochastic_fit <-"
"0","  p_wpa +"
"0","  geom_path("
"0","    aes("
"0","      x = game_seconds_played/60,"
"0","      y = lower_bound_1"
"0","    ),"
"0","    data = stochastic_model,"
"0","    color = ""red"""
"0","  ) +"
"0","  geom_path("
"0","    aes("
"0","      x = game_seconds_played/60,"
"0","      y = lower_bound_2"
"0","    ),"
"0","    data = stochastic_model,"
"0","    color = ""red"""
"0","  ) +"
"0","  geom_path("
"0","    aes("
"0","      x = game_seconds_played/60,"
"0","      y = upper_bound_1"
"0","    ),"
"0","    data = stochastic_model,"
"0","    color = ""red"""
"0","  ) +"
"0","  geom_path("
"0","    aes("
"0","      x = game_seconds_played/60,"
"0","      y = upper_bound_2"
"0","    ),"
"0","    data = stochastic_model,"
"0","    color = ""red"""
"0","  )"
"0",""
"0","ggsave("
"0","  filename = ""stochastic_fit.png"","
"0","  plot = p_stochastic_fit,"
"0","  height = 8,"
"0","  width = 5,"
"0","  units = ""in"","
"0","  dpi = ""retina"""
"0",")"
"0",""
